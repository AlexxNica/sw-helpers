/*
 Copyright 2016 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define(t):(e.goog=e.goog||{},e.goog.swlib=t())})(this,function(){'use strict';function e(_e,ve){for(var Ce,be=[],Ee=0,Ne=0,xe='',qe=ve&&ve.delimiter||'/';null!=(Ce=T.exec(_e));){var Ie=Ce[0],ke=Ce[1],Te=Ce.index;if(xe+=_e.slice(Ne,Te),Ne=Te+Ie.length,ke){xe+=ke[1];continue}var we=_e[Ne],Se=Ce[2],De=Ce[3],Pe=Ce[4],je=Ce[5],Ae=Ce[6],Me=Ce[7];xe&&(be.push(xe),xe='');var Oe=Ce[2]||qe,We=Pe||je;be.push({name:De||Ee++,prefix:Se||'',delimiter:Oe,optional:'?'===Ae||'*'===Ae,repeat:'+'===Ae||'*'===Ae,partial:null!=Se&&null!=we&&we!==Se,asterisk:!!Me,pattern:We?s(We):Me?'.*':'[^'+n(Oe)+']+?'})}return Ne<_e.length&&(xe+=_e.substr(Ne)),xe&&be.push(xe),be}function t(_e){return encodeURI(_e).replace(/[\/?#]/g,function(ve){return'%'+ve.charCodeAt(0).toString(16).toUpperCase()})}function r(_e){return encodeURI(_e).replace(/[?#]/g,function(ve){return'%'+ve.charCodeAt(0).toString(16).toUpperCase()})}function a(_e){var ve=Array(_e.length);for(var be=0;be<_e.length;be++)'object'==typeof _e[be]&&(ve[be]=new RegExp('^(?:'+_e[be].pattern+')$'));return function(Ee,Ne){var xe='',qe=Ee||{},Ce=(Ne||{}).pretty?t:encodeURIComponent;for(var Ie=0;Ie<_e.length;Ie++){var ke=_e[Ie];if('string'==typeof ke){xe+=ke;continue}var we,Te=qe[ke.name];if(null==Te)if(ke.optional){ke.partial&&(xe+=ke.prefix);continue}else throw new TypeError('Expected "'+ke.name+'" to be defined');if(I(Te)){if(!ke.repeat)throw new TypeError('Expected "'+ke.name+'" to not repeat, but received `'+JSON.stringify(Te)+'`');if(0===Te.length)if(ke.optional)continue;else throw new TypeError('Expected "'+ke.name+'" to not be empty');for(var Se=0;Se<Te.length;Se++){if(we=Ce(Te[Se]),!ve[Ie].test(we))throw new TypeError('Expected all "'+ke.name+'" to match "'+ke.pattern+'", but received `'+JSON.stringify(we)+'`');xe+=(0===Se?ke.prefix:ke.delimiter)+we}continue}if(we=ke.asterisk?r(Te):Ce(Te),!ve[Ie].test(we))throw new TypeError('Expected "'+ke.name+'" to match "'+ke.pattern+'", but received "'+we+'"');xe+=ke.prefix+we}return xe}}function n(_e){return _e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function s(_e){return _e.replace(/([=!:$\/()])/g,'\\$1')}function o(_e,ve){return _e.keys=ve,_e}function d(_e){return _e.sensitive?'':'i'}function l(_e,ve){var be=_e.source.match(/\((?!\?)/g);if(be)for(var Ee=0;Ee<be.length;Ee++)ve.push({name:Ee,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return o(_e,ve)}function h(_e,ve,be){var Ee=[];for(var Ne=0;Ne<_e.length;Ne++)Ee.push(y(_e[Ne],ve,be).source);var xe=new RegExp('(?:'+Ee.join('|')+')',d(be));return o(xe,ve)}function u(_e,ve,be){return g(e(_e,be),ve,be)}function g(_e,ve,be){I(ve)||(be=ve||be,ve=[]),be=be||{};var Ee=be.strict,Ne=!1!==be.end,xe='';for(var qe=0;qe<_e.length;qe++){var Ce=_e[qe];if('string'==typeof Ce)xe+=n(Ce);else{var Ie=n(Ce.prefix),ke='(?:'+Ce.pattern+')';ve.push(Ce),Ce.repeat&&(ke+='(?:'+Ie+ke+')*'),ke=Ce.optional?Ce.partial?Ie+'('+ke+')?':'(?:'+Ie+'('+ke+'))?':Ie+'('+ke+')',xe+=ke}}var Te=n(be.delimiter||'/'),we=xe.slice(-Te.length)===Te;return Ee||(xe=(we?xe.slice(0,-Te.length):xe)+'(?:'+Te+'(?=$))?'),xe+=Ne?'$':Ee&&we?'':'(?='+Te+'|$)',o(new RegExp('^'+xe,d(be)),ve)}function y(_e,ve,be){return I(ve)||(be=ve||be,ve=[]),be=be||{},_e instanceof RegExp?l(_e,ve):I(_e)?h(_e,ve,be):u(_e,ve,be)}function f({channel:_e,cacheName:ve,url:be,source:Ee}){N.isInstance({channel:_e},BroadcastChannel),N.isType({cacheName:ve},'string'),N.isType({source:Ee},'string'),N.isType({url:be},'string'),_e.postMessage({type:'CACHE_UPDATED',meta:Ee,payload:{cacheName:ve,updatedUrl:be}})}function _({first:_e,second:ve,headersToCheck:be}){return N.isInstance({first:_e},Response),N.isInstance({second:ve},Response),N.isInstance({headersToCheck:be},Array),be.every(Ee=>{return _e.headers.has(Ee)===ve.headers.has(Ee)&&_e.headers.get(Ee)===ve.headers.get(Ee)})}class v{constructor(_e){this._errors=_e}createError(_e,ve){if(!(_e in this._errors))throw new Error(`Unable to generate error '${_e}'.`);let be=this._errors[_e],Ee=null;ve&&(be+=` [${ve.message}]`,Ee=ve.stack);const Ne=new Error;return Ne.name=_e,Ne.message=be,Ne.stack=Ee,Ne}}const b={'not-in-sw':'sw-lib must be loaded in your service worker file.','unsupported-route-type':'Routes must be either a express style route string, a Regex to capture request URLs or a Route instance.','empty-express-string':'The Express style route string must have some characters, an empty string is invalid.','bad-revisioned-cache-list':`The 'cacheRevisionedAssets()' method expects`+`an array of revisioned urls like so: ['/example/hello.1234.txt', `+`{path: 'hello.txt', revision: '1234'}]`};var E=new v(b),N={atLeastOne:function(ve){const be=Object.keys(ve);if(!be.some(Ee=>void 0!==ve[Ee]))throw Error('Please set at least one of the following parameters: '+be.map(Ee=>`'${Ee}'`).join(', '))},hasMethod:function(ve,be){const Ee=Object.keys(ve).pop(),Ne=typeof ve[Ee][be];if('function'!=Ne)throw Error(`The '${Ee}' parameter must be an object that exposes `+`a '${be}' method.`)},isInstance:function(ve,be){const Ee=Object.keys(ve).pop();if(!(ve[Ee]instanceof be))throw Error(`The '${Ee}' parameter must be an instance of `+`'${be.name}'`)},isOneOf:function(ve,be){const Ee=Object.keys(ve).pop();if(!be.includes(ve[Ee]))throw Error(`The '${Ee}' parameter must be set to one of the `+`following: ${be}`)},isType:function(ve,be){const Ee=Object.keys(ve).pop(),Ne=typeof ve[Ee];if(Ne!==be)throw Error(`The '${Ee}' parameter has the wrong type. `+`(Expected: ${be}, actual: ${Ne})`)},isSWEnv:function(){return'ServiceWorkerGlobalScope'in self&&self instanceof ServiceWorkerGlobalScope},isValue:function(ve,be){const Ee=Object.keys(ve).pop(),Ne=ve[Ee];if(Ne!==be)throw Error(`The '${Ee}' parameter has the wrong value. `+`(Expected: ${be}, actual: ${Ne})`)}};const x=['DELETE','GET','HEAD','POST','PUT'];class q{constructor({match:_e,handler:ve,method:be}={}){N.isType({match:_e},'function'),N.hasMethod({handler:ve},'handle'),this.match=_e,this.handler=ve,be?(N.isOneOf({method:be},x),this.method=be):this.method='GET'}}var C=Array.isArray||function(_e){return'[object Array]'==Object.prototype.toString.call(_e)},I=C,k=y,T=new RegExp(['(\\\\.)','([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))'].join('|'),'g');k.parse=e,k.compile=function(ve,be){return a(e(ve,be))},k.tokensToFunction=a,k.tokensToRegExp=g;class w extends q{constructor({path:_e,handler:ve,method:be}){N.isType({path:_e},'string');let Ee=[];const Ne=k(_e,Ee);super({match:({url:xe})=>{const qe=xe.pathname.match(Ne);if(!qe)return null;const Ce={};return Ee.forEach((Ie,ke)=>{Ce[Ie.name]=qe[ke+1]}),Ce},handler:ve,method:be})}}class S extends q{constructor({regExp:_e,handler:ve,method:be}){N.isInstance({regExp:_e},RegExp),super({match:({url:Ee})=>{const Ne=Ee.href.match(_e);return Ne?Ne.slice(1):null},handler:ve,method:be})}}class D{setDefaultHandler({handler:_e}={}){N.hasMethod({handler:_e},'handle'),this.defaultHandler=_e}setCatchHandler({handler:_e}={}){N.hasMethod({handler:_e},'handle'),this.catchHandler=_e}registerRoutes({routes:_e}={}){N.isInstance({routes:_e},Array),self.addEventListener('fetch',ve=>{const be=new URL(ve.request.url);if(be.protocol.startsWith('http')){let Ee;for(let Ne of _e||[])if(Ne.method===ve.request.method){const xe=Ne.match({url:be,event:ve});if(xe){let qe=xe;Array.isArray(qe)&&0===qe.length?qe=void 0:qe.constructor===Object&&0===Object.keys(qe).length&&(qe=void 0),Ee=Ne.handler.handle({url:be,event:ve,params:qe});break}}!Ee&&this.defaultHandler&&(Ee=this.defaultHandler.handle({url:be,event:ve})),Ee&&this.catchHandler&&(Ee=Ee.catch(Ne=>{return this.catchHandler.handle({url:be,event:ve,error:Ne})})),Ee&&ve.respondWith(Ee)}})}registerRoute({route:_e}={}){N.isInstance({route:_e},q),this.registerRoutes({routes:[_e]})}}class P{constructor(){this._router=new D}registerRoute(_e,ve){if('function'==typeof ve&&(ve={handle:ve}),'string'==typeof _e){if(0===_e.length)throw E.createError('empty-express-string');this._router.registerRoute({route:new w({path:_e,handler:ve})})}else if(_e instanceof RegExp)this._router.registerRoute({route:new S({regExp:_e,handler:ve})});else if(_e instanceof q)this._router.registerRoute({route:_e});else throw E.createError('unsupported-route-type')}}const A={'not-in-sw':'sw-precaching must be loaded in your service worker file.','invalid-revisioned-entry':`File manifest entries must be either a `+`string with revision info in the url or an object with a 'url' and `+`'revision' parameters.`,'invalid-unrevisioned-entry':``,'bad-cache-bust':`The cache bust parameter must be a boolean.`,'duplicate-entry-diff-revisions':`An attempt was made to cache the same `+`url twice with each having different revisions. This is not supported.`,'request-not-cached':`A request failed the criteria to be cached. By `+`default, only responses with 'response.ok = true' are cached.`,'should-override':'Method should be overridden by the extending class.'};var M=new v(A),O=function(_e){return function(){var ve=_e.apply(this,arguments);return new Promise(function(be,Ee){function Ne(xe,qe){try{var Ce=ve[xe](qe),Ie=Ce.value}catch(ke){return void Ee(ke)}return Ce.done?void be(Ie):Promise.resolve(Ie).then(function(ke){Ne('next',ke)},function(ke){Ne('throw',ke)})}return Ne('next')})}};class W{constructor(_e){this._entriesToCache=new Map,this._cacheName=_e}cache(_e){_e.forEach(ve=>{this._addEntryToInstallList(this._parseEntry(ve))})}_addEntryToInstallList(_e){const ve=_e.entryID,be=this._entriesToCache.get(_e.entryID);return be?void this._onDuplicateInstallEntryFound(_e,be):void this._entriesToCache.set(ve,_e)}_performInstallStep(){var _e=this;return O(function*(){if(0!==_e._entriesToCache.size){const ve=[];return _e._entriesToCache.forEach(function(be){ve.push(_e._cacheEntry(be))}),Promise.all(ve)}})()}_cacheEntry(_e){var ve=this;return O(function*(){const be=yield ve._isAlreadyCached(_e);if(!be){let Ee=yield fetch(_e.getNetworkRequest(),{credentials:'same-origin',redirect:'follow'});if(Ee.ok){const Ne=yield ve._getCache();return yield Ne.put(_e.request,Ee),ve._onEntryCached(_e)}throw M.createError('request-not-cached',{message:`Failed to get a cacheable response for `+`'${_e.request.url}'`})}})()}_cleanUpOldEntries(){var _e=this;return O(function*(){if(yield caches.has(_e._cacheName)){const ve=[];_e._entriesToCache.forEach(function(xe){ve.push(xe.request.url)});const be=yield _e._getCache(),Ee=yield be.keys(),Ne=Ee.filter(function(xe){return!ve.includes(xe.url)});return Promise.all(Ne.map(function(xe){return be.delete(xe)}))}})()}_getCache(){var _e=this;return O(function*(){return _e._cache||(_e._cache=yield caches.open(_e._cacheName)),_e._cache})()}_parseEntry(_e){throw M.createError('should-override')}_onDuplicateEntryFound(_e,ve){throw M.createError('should-override')}_isAlreadyCached(_e){throw M.createError('should-override')}_onEntryCached(_e){throw M.createError('should-override')}}var R=function(ve,be){return be={exports:{}},ve(be,be.exports),be.exports}(function(_e){'use strict';(function(){function ve(Ae){return Array.prototype.slice.call(Ae)}function be(Ae){return new Promise(function(Me,Oe){Ae.onsuccess=function(){Me(Ae.result)},Ae.onerror=function(){Oe(Ae.error)}})}function Ee(Ae,Me,Oe){var We,Re=new Promise(function(Ue,Be){We=Ae[Me].apply(Ae,Oe),be(We).then(Ue,Be)});return Re.request=We,Re}function Ne(Ae,Me,Oe){var We=Ee(Ae,Me,Oe);return We.then(function(Re){if(Re)return new Te(Re,We.request)})}function xe(Ae,Me,Oe){Oe.forEach(function(We){Object.defineProperty(Ae.prototype,We,{get:function(){return this[Me][We]},set:function(Re){this[Me][We]=Re}})})}function qe(Ae,Me,Oe,We){We.forEach(function(Re){Re in Oe.prototype&&(Ae.prototype[Re]=function(){return Ee(this[Me],Re,arguments)})})}function Ce(Ae,Me,Oe,We){We.forEach(function(Re){Re in Oe.prototype&&(Ae.prototype[Re]=function(){return this[Me][Re].apply(this[Me],arguments)})})}function Ie(Ae,Me,Oe,We){We.forEach(function(Re){Re in Oe.prototype&&(Ae.prototype[Re]=function(){return Ne(this[Me],Re,arguments)})})}function ke(Ae){this._index=Ae}function Te(Ae,Me){this._cursor=Ae,this._request=Me}function we(Ae){this._store=Ae}function Se(Ae){this._tx=Ae,this.complete=new Promise(function(Me,Oe){Ae.oncomplete=function(){Me()},Ae.onerror=function(){Oe(Ae.error)},Ae.onabort=function(){Oe(Ae.error)}})}function De(Ae,Me,Oe){this._db=Ae,this.oldVersion=Me,this.transaction=new Se(Oe)}function Pe(Ae){this._db=Ae}xe(ke,'_index',['name','keyPath','multiEntry','unique']),qe(ke,'_index',IDBIndex,['get','getKey','getAll','getAllKeys','count']),Ie(ke,'_index',IDBIndex,['openCursor','openKeyCursor']),xe(Te,'_cursor',['direction','key','primaryKey','value']),qe(Te,'_cursor',IDBCursor,['update','delete']),['advance','continue','continuePrimaryKey'].forEach(function(Ae){Ae in IDBCursor.prototype&&(Te.prototype[Ae]=function(){var Me=this,Oe=arguments;return Promise.resolve().then(function(){return Me._cursor[Ae].apply(Me._cursor,Oe),be(Me._request).then(function(We){if(We)return new Te(We,Me._request)})})})}),we.prototype.createIndex=function(){return new ke(this._store.createIndex.apply(this._store,arguments))},we.prototype.index=function(){return new ke(this._store.index.apply(this._store,arguments))},xe(we,'_store',['name','keyPath','indexNames','autoIncrement']),qe(we,'_store',IDBObjectStore,['put','add','delete','clear','get','getAll','getKey','getAllKeys','count']),Ie(we,'_store',IDBObjectStore,['openCursor','openKeyCursor']),Ce(we,'_store',IDBObjectStore,['deleteIndex']),Se.prototype.objectStore=function(){return new we(this._tx.objectStore.apply(this._tx,arguments))},xe(Se,'_tx',['objectStoreNames','mode']),Ce(Se,'_tx',IDBTransaction,['abort']),De.prototype.createObjectStore=function(){return new we(this._db.createObjectStore.apply(this._db,arguments))},xe(De,'_db',['name','version','objectStoreNames']),Ce(De,'_db',IDBDatabase,['deleteObjectStore','close']),Pe.prototype.transaction=function(){return new Se(this._db.transaction.apply(this._db,arguments))},xe(Pe,'_db',['name','version','objectStoreNames']),Ce(Pe,'_db',IDBDatabase,['close']),['openCursor','openKeyCursor'].forEach(function(Ae){[we,ke].forEach(function(Me){Me.prototype[Ae.replace('open','iterate')]=function(){var Oe=ve(arguments),We=Oe[Oe.length-1],Re=this._store||this._index,Ue=Re[Ae].apply(Re,Oe.slice(0,-1));Ue.onsuccess=function(){We(Ue.result)}}})}),[ke,we].forEach(function(Ae){Ae.prototype.getAll||(Ae.prototype.getAll=function(Me,Oe){var We=this,Re=[];return new Promise(function(Ue){We.iterateCursor(Me,function(Be){return Be?(Re.push(Be.value),void 0!==Oe&&Re.length==Oe?void Ue(Re):void Be.continue()):void Ue(Re)})})})});var je={open:function(Ae,Me,Oe){var We=Ee(indexedDB,'open',[Ae,Me]),Re=We.request;return Re.onupgradeneeded=function(Ue){Oe&&Oe(new De(Re.result,Ue.oldVersion,Re.transaction))},We.then(function(Ue){return new Pe(Ue)})},delete:function(Ae){return Ee(indexedDB,'deleteDatabase',[Ae])}};_e.exports=je})()});class U{constructor(_e,ve,be){if(void 0==_e||void 0==ve||void 0==be)throw Error('name, version, storeName must be passed to the constructor.');this._name=_e,this._version=ve,this._storeName=be}_getDb(){return this._dbPromise?this._dbPromise:(this._dbPromise=R.open(this._name,this._version,_e=>{_e.createObjectStore(this._storeName)}).then(_e=>{return _e}),this._dbPromise)}close(){return this._dbPromise?this._dbPromise.then(_e=>{_e.close(),this._dbPromise=null}):void 0}put(_e,ve){return this._getDb().then(be=>{const Ee=be.transaction(this._storeName,'readwrite'),Ne=Ee.objectStore(this._storeName);return Ne.put(ve,_e),Ee.complete})}delete(_e){return this._getDb().then(ve=>{const be=ve.transaction(this._storeName,'readwrite'),Ee=be.objectStore(this._storeName);return Ee.delete(_e),be.complete})}get(_e){return this._getDb().then(ve=>{return ve.transaction(this._storeName).objectStore(this._storeName).get(_e)})}getAllValues(){return this._getDb().then(_e=>{return _e.transaction(this._storeName).objectStore(this._storeName).getAll()})}getAllKeys(){return this._getDb().then(_e=>{return _e.transaction(this._storeName).objectStore(this._storeName).getAllKeys()})}}const B='v1';let K=`sw-precaching-revisioned-${B}`,F=`sw-precaching-unrevisioned-${B}`;self&&self.registration&&(K+=`-${self.registration.scope}`,F+=`-${self.registration.scope}`);const H=K,L=F;class ${constructor(){this._idbHelper=new U('sw-precaching','1','asset-revisions')}get(_e){return this._idbHelper.get(_e)}put(_e,ve){return this._idbHelper.put(_e,ve)}_close(){this._idbHelper.close()}}class G{constructor({entryID:_e,revision:ve,request:be,cacheBust:Ee}){this.entryID=_e,this.revision=ve,this.request=be,this.cacheBust=Ee}getNetworkRequest(){if(!0!==this.cacheBust)return this.request;let _e=this.request.url;const ve={};if(!0===this.cacheBust)if('cache'in Request.prototype)ve.cache='reload';else{const be=new URL(_e,location);be.search+=(be.search?'&':'')+encodeURIComponent('_sw-precaching')+'='+encodeURIComponent(this.revision),_e=be.toString()}return new Request(_e,ve)}}class V extends G{constructor(_e){if(N.isType({url:_e},'string'),0===_e.length)throw M.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(_e)));super({entryID:_e,revision:_e,request:new Request(_e),cacheBust:!1})}}class z extends G{constructor({entryID:_e,revision:ve,url:be,cacheBust:Ee}){if('undefined'==typeof Ee&&(Ee=!0),'undefined'==typeof _e&&(_e=new URL(be,location).toString()),N.isType({revision:ve},'string'),0===ve.length)throw M.createError('invalid-revisioned-entry',new Error('Bad revision Parameter. It should be a string with at least one character: '+JSON.stringify(ve)));if(N.isType({url:be},'string'),0===be.length)throw M.createError('invalid-revisioned-entry',new Error('Bad url Parameter. It should be a string:'+JSON.stringify(be)));if(N.isType({entryID:_e},'string'),0===_e.length)throw M.createError('invalid-revisioned-entry',new Error('Bad entryID Parameter. It should be a string with at least one character: '+JSON.stringify(_e)));N.isType({cacheBust:Ee},'boolean'),super({entryID:_e,revision:ve,request:new Request(be),cacheBust:Ee})}}class Y extends W{constructor(){super(H),this._revisionDetailsModel=new $}cache(_e){super.cache(_e)}_parseEntry(_e){if('undefined'==typeof _e||null===_e)throw M.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(_e)));let ve;switch(typeof _e){case'string':ve=new V(_e);break;case'object':ve=new z(_e);break;default:throw M.createError('invalid-revisioned-entry',new Error('Invalid file entry: '+JSON.stringify(ve)));}return ve}_onDuplicateInstallEntryFound(_e,ve){if(ve.revision!==_e.revision)throw M.createError('duplicate-entry-diff-revisions',new Error(`${JSON.stringify(ve)} <=> `+`${JSON.stringify(_e)}`))}_isAlreadyCached(_e){var ve=this;return O(function*(){const be=yield ve._revisionDetailsModel.get(_e.entryID);if(be!==_e.revision)return!1;const Ee=yield ve._getCache(),Ne=yield Ee.match(_e.request);return!!Ne})()}_onEntryCached(_e){var ve=this;return O(function*(){yield ve._revisionDetailsModel.put(_e.entryID,_e.revision)})()}_close(){this._revisionDetailsModel._close()}}class J extends G{constructor(_e){if(!(_e instanceof Request))throw M.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(_e)));super({entryID:_e.url,request:_e,cacheBust:!1})}}class Q extends W{constructor(){super(L)}cache(_e){super.cache(_e)}_parseEntry(_e){if('undefined'==typeof _e||null===_e)throw M.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(_e)));if('string'==typeof _e)return new V(_e);if(_e instanceof Request)return new J(_e);throw M.createError('invalid-unrevisioned-entry',new Error('Invalid file entry: '+JSON.stringify(_e)))}_onDuplicateInstallEntryFound(_e,ve){}_isAlreadyCached(_e){return O(function*(){return!1})()}_onEntryCached(_e){}}class X{constructor(){this._eventsRegistered=!1,this._revisionedManager=new Y,this._unrevisionedManager=new Q,this._registerEvents()}_registerEvents(){this._eventsRegistered||(this._eventsRegistered=!0,self.addEventListener('install',_e=>{const ve=Promise.all([this._revisionedManager._performInstallStep(),this._unrevisionedManager._performInstallStep()]).then(()=>{this._close()}).catch(be=>{throw this._close(),be});_e.waitUntil(ve)}),self.addEventListener('activate',_e=>{const ve=Promise.all([this._revisionedManager._cleanUpOldEntries(),this._unrevisionedManager._cleanUpOldEntries()]).then(()=>{this._close()}).catch(be=>{throw this._close(),be});_e.waitUntil(ve)}))}cacheRevisioned({revisionedFiles:_e}={}){N.isInstance({revisionedFiles:_e},Array),this._revisionedManager.cache(_e)}cacheUnrevisioned({unrevisionedFiles:_e}={}){N.isInstance({unrevisionedFiles:_e},Array),this._unrevisionedManager.cache(_e)}_close(){this._revisionedManager._close()}}if(!N.isSWEnv())throw M.createError('not-in-sw');const Z=`sw-cache-expiration-${self.registration.scope}`,ee='url',te='timestamp';class ae{constructor({maxEntries:_e,maxAgeSeconds:ve}={}){N.atLeastOne({maxEntries:_e,maxAgeSeconds:ve}),void 0!==_e&&N.isType({maxEntries:_e},'number'),void 0!==ve&&N.isType({maxAgeSeconds:ve},'number'),this.maxEntries=_e,this.maxAgeSeconds=ve,this._dbs=new Map,this._caches=new Map}getDB({cacheName:_e}){var ve=this;return O(function*(){if(!ve._dbs.has(_e)){const be=yield R.open(Z,1,function(Ee){const Ne=Ee.createObjectStore(_e,{keyPath:ee});Ne.createIndex(te,te,{unique:!1})});ve._dbs.set(_e,be)}return ve._dbs.get(_e)})()}getCache({cacheName:_e}){var ve=this;return O(function*(){if(!ve._caches.has(_e)){const be=yield caches.open(_e);ve._caches.set(_e,be)}return ve._caches.get(_e)})()}cacheDidUpdate({cacheName:_e,newResponse:ve}={}){N.isType({cacheName:_e},'string'),N.isInstance({newResponse:ve},Response);const be=Date.now();this.updateTimestamp({cacheName:_e,now:be,url:ve.url}).then(()=>{this.expireEntries({cacheName:_e,now:be})})}updateTimestamp({cacheName:_e,url:ve,now:be}){var Ee=this;return O(function*(){N.isType({url:ve},'string'),'undefined'==typeof be&&(be=Date.now());const Ne=yield Ee.getDB({cacheName:_e}),xe=Ne.transaction(_e,'readwrite');xe.objectStore(_e).put({[te]:be,[ee]:ve}),yield xe.complete})()}expireEntries({cacheName:_e,now:ve}={}){var be=this;return O(function*(){'undefined'==typeof ve&&(ve=Date.now());const Ee=be.maxAgeSeconds?yield be.findOldEntries({cacheName:_e,now:ve}):[],Ne=be.maxEntries?yield be.findExtraEntries({cacheName:_e}):[],xe=[...new Set(Ee.concat(Ne))];return yield be.deleteFromCacheAndIDB({cacheName:_e,urls:xe}),xe})()}findOldEntries({cacheName:_e,now:ve}={}){var be=this;return O(function*(){N.isType({now:ve},'number');const Ee=ve-1000*be.maxAgeSeconds,Ne=[],xe=yield be.getDB({cacheName:_e}),qe=xe.transaction(_e,'readonly'),Ce=qe.objectStore(_e),Ie=Ce.index(te);return Ie.iterateCursor(function(ke){ke&&(ke.value[te]<Ee&&Ne.push(ke.value[ee]),ke.continue())}),yield qe.complete,Ne})()}findExtraEntries({cacheName:_e}){var ve=this;return O(function*(){const be=[],Ee=yield ve.getDB({cacheName:_e}),Ne=Ee.transaction(_e,'readonly'),xe=Ne.objectStore(_e),qe=xe.index(te),Ce=yield qe.count();return Ce>ve.maxEntries&&qe.iterateCursor(function(Ie){Ie&&(be.push(Ie.value[ee]),Ce-be.length>ve.maxEntries&&Ie.continue())}),yield Ne.complete,be})()}deleteFromCacheAndIDB({cacheName:_e,urls:ve}={}){var be=this;return O(function*(){if(N.isInstance({urls:ve},Array),0<ve.length){const Ee=yield be.getCache({cacheName:_e}),Ne=yield be.getDB({cacheName:_e});yield ve.forEach((()=>{var xe=O(function*(qe){yield Ee.delete(qe);const Ce=Ne.transaction(_e,'readwrite'),Ie=Ce.objectStore(_e);yield Ie.delete(qe),yield Ce.complete});return function(qe){return xe.apply(this,arguments)}})())}})()}}const ne=['content-length','etag','last-modified'];class se{constructor({channelName:_e,headersToCheck:ve,source:be}){N.isType({channelName:_e},'string'),this.channelName=_e,this.headersToCheck=ve||ne,this.source=be||'sw-broadcast-cache-update'}get channel(){return this._channel||(this._channel=new BroadcastChannel(this.channelName)),this._channel}cacheDidUpdate({cacheName:_e,oldResponse:ve,newResponse:be}){N.isType({cacheName:_e},'string'),N.isInstance({newResponse:be},Response),ve&&this.notifyIfUpdated({cacheName:_e,first:ve,second:be})}notifyIfUpdated({first:_e,second:ve,cacheName:be}){N.isType({cacheName:be},'string'),_({first:_e,second:ve,headersToCheck:this.headersToCheck})||f({cacheName:be,url:ve.url,channel:this.channel,source:this.source})}}const ie=`sw-runtime-caching-${self.registration.scope}`,oe=['cacheDidUpdate','cacheWillUpdate','fetchDidFail','requestWillFetch'];var ce=new v({'multiple-cache-will-update-behaviors':'You cannot register more than one behavior that implements cacheWillUpdate.'});class de{constructor({cacheName:_e,behaviors:ve,fetchOptions:be,matchOptions:Ee}={}){if(_e?(N.isType({cacheName:_e},'string'),this.cacheName=_e):this.cacheName=ie,be&&(N.isType({fetchOptions:be},'object'),this.fetchOptions=be),Ee&&(N.isType({matchOptions:Ee},'object'),this.matchOptions=Ee),this.behaviorCallbacks={},ve&&(N.isInstance({behaviors:ve},Array),ve.forEach(Ne=>{for(let xe of oe)'function'==typeof Ne[xe]&&(this.behaviorCallbacks[xe]||(this.behaviorCallbacks[xe]=[]),this.behaviorCallbacks[xe].push(Ne[xe].bind(Ne)))})),this.behaviorCallbacks.cacheWillUpdate&&1!==this.behaviorCallbacks.cacheWillUpdate.length)throw ce.createError('multiple-cache-will-update-behaviors')}getCache(){var _e=this;return O(function*(){return _e._cache||(_e._cache=yield caches.open(_e.cacheName)),_e._cache})()}match({request:_e}){var ve=this;return O(function*(){N.atLeastOne({request:_e});const be=yield ve.getCache();return yield be.match(_e,ve.matchOptions)})()}fetch({request:_e}){var ve=this;return O(function*(){return N.atLeastOne({request:_e}),yield fetch(_e,ve.fetchOptions).catch(function(be){if(ve.behaviorCallbacks.fetchDidFail)for(let Ee of ve.behaviorCallbacks.fetchDidFail)Ee({request:_e});throw be})})()}fetchAndCache({request:_e,waitOnCache:ve}){var be=this;return O(function*(){N.atLeastOne({request:_e});let Ee;const Ne=yield be.fetch({request:_e});let xe=Ne.ok;if(be.behaviorCallbacks.cacheWillUpdate&&(xe=be.behaviorCallbacks.cacheWillUpdate[0]({request:_e,response:Ne})),xe){const qe=Ne.clone();Ee=be.getCache().then((()=>{var Ce=O(function*(Ie){let ke;'opaque'!==Ne.type&&be.behaviorCallbacks.cacheDidUpdate&&(ke=yield be.match({request:_e})),yield Ie.put(_e,qe);for(let Te of be.behaviorCallbacks.cacheDidUpdate||[])Te({cacheName:be.cacheName,oldResponse:ke,newResponse:qe})});return function(Ie){return Ce.apply(this,arguments)}})())}return ve&&Ee&&(yield Ee),Ne})()}}class le{constructor({requestWrapper:_e}={}){this.requestWrapper=_e?_e:new de}handle({event:_e,params:ve}={}){throw Error('This abstract method must be implemented in a subclass.')}}class he extends le{handle({event:_e}={}){var ve=this;return O(function*(){N.isInstance({event:_e},FetchEvent);const be=yield ve.requestWrapper.match({request:_e.request});return be||(yield ve.requestWrapper.fetchAndCache({request:_e.request}))})()}}class pe extends le{handle({event:_e}={}){var ve=this;return O(function*(){return N.isInstance({event:_e},FetchEvent),yield ve.requestWrapper.match({request:_e.request})})()}}class ue extends le{handle({event:_e}={}){var ve=this;return O(function*(){N.isInstance({event:_e},FetchEvent);let be;try{if(be=yield ve.requestWrapper.fetchAndCache({request:_e.request}),be)return be}catch(Ee){}return yield ve.requestWrapper.match({request:_e.request})})()}}class me extends le{handle({event:_e}={}){var ve=this;return O(function*(){return N.isInstance({event:_e},FetchEvent),yield ve.requestWrapper.fetch({request:_e.request})})()}}class ge extends le{handle({event:_e}={}){var ve=this;return O(function*(){N.isInstance({event:_e},FetchEvent);const be=ve.requestWrapper.fetchAndCache({request:_e.request}).catch(function(){return Response.error()}),Ee=yield ve.requestWrapper.match({request:_e.request});return Ee||(yield be)})()}}class ye{constructor(){this._router=new P,this._precacheManager=new X}cacheRevisionedAssets(_e){if(!Array.isArray(_e))throw E.createError('bad-revisioned-cache-list');this._precacheManager.cacheRevisioned({revisionedFiles:_e})}warmRuntimeCache(_e){if(!Array.isArray(_e))throw E.createError('bad-revisioned-cache-list');this._precacheManager.cacheUnrevisioned({unrevisionedFiles:_e})}get router(){return this._router}cacheFirst(_e){return this._getCachingMechanism(he,_e)}cacheOnly(_e){return this._getCachingMechanism(pe,_e)}networkFirst(_e){return this._getCachingMechanism(ue,_e)}networkOnly(_e){return this._getCachingMechanism(me,_e)}staleWhileRevalidate(_e){return this._getCachingMechanism(ge,_e)}_getCachingMechanism(_e,ve={}){const be={cacheExpiration:ae,broadcastCacheUpdate:se},Ee={behaviors:[]};ve.cacheName&&(Ee.cacheName=ve.cacheName);const Ne=Object.keys(be);return Ne.forEach(xe=>{if(ve[xe]){const qe=be[xe],Ce=ve[xe];Ee.behaviors.push(new qe(Ce))}}),ve.behaviors&&ve.behaviors.forEach(xe=>{Ee.behaviors.push(xe)}),new _e({requestWrapper:new de(Ee)})}}if(!N.isSWEnv())throw E.createError('not-in-sw');const fe=new ye;return fe.Route=q,fe});
//# sourceMappingURL=sw-lib.min.js.map
